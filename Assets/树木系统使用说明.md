# æ ‘æœ¨ç³»ç»Ÿä½¿ç”¨è¯´æ˜

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

æ ‘æœ¨ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¸ç”µåŠ›çº¿ç³»ç»Ÿå®Œå…¨é›†æˆçš„ç¯å¢ƒç¾åŒ–æ¨¡å—ï¼Œå¯ä»¥åœ¨å»ºç«‹ç”µå¡”å’Œç”µçº¿çš„åŒæ—¶è‡ªåŠ¨åœ¨åœºæ™¯ä¸­æ”¾ç½®æ ‘æœ¨ï¼Œè®©ç”µåŠ›çº¿å·¡æ£€åœºæ™¯æ›´åŠ è‡ªç„¶å’ŒçœŸå®ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

### ğŸš€ è‡ªåŠ¨é›†æˆ
- **æ— ç¼é›†æˆ**: ä¸PowerlineExtractionSceneBuilderå®Œå…¨é›†æˆ
- **è‡ªåŠ¨è§¦å‘**: åœ¨å»ºç«‹ç”µåŠ›çº¿æ—¶è‡ªåŠ¨æ”¾ç½®æ ‘æœ¨
- **æ™ºèƒ½æ¸…ç†**: åœºæ™¯é‡å»ºæ—¶è‡ªåŠ¨æ¸…ç†æ—§æ ‘æœ¨

### ğŸŒ³ æ™ºèƒ½æ”¾ç½®
- **åŸºäºCSVæ•°æ®**: ä»trees.csvæ–‡ä»¶åŠ è½½ç²¾ç¡®çš„æ ‘æœ¨ä½ç½®
- **ç”µå¡”å…³è”**: æ¯ä¸ªæ ‘æœ¨éƒ½ä¸ç‰¹å®šç”µå¡”å…³è”
- **éšæœºè¡¥å……**: åœ¨ç”µå¡”é™„è¿‘è‡ªåŠ¨æ·»åŠ éšæœºæ ‘æœ¨

### ğŸ¨ è§†è§‰æ•ˆæœ
- **éšæœºæ—‹è½¬**: æ¯æ£µæ ‘éƒ½æœ‰éšæœºçš„æ—‹è½¬è§’åº¦
- **éšæœºç¼©æ”¾**: æ”¯æŒ0.8-1.2å€çš„éšæœºç¼©æ”¾
- **è‡ªåŠ¨é«˜åº¦**: è‡ªåŠ¨è°ƒæ•´æ ‘æœ¨é«˜åº¦ä»¥è´´åˆåœ°å½¢

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

### å¿…éœ€ç»„ä»¶
- `PowerlineExtractionSceneBuilder` - ç”µåŠ›çº¿åœºæ™¯æ„å»ºå™¨
- `Tree.prefab` - æ ‘æœ¨é¢„åˆ¶ä½“ï¼ˆä½äºResources/Prefabs/ç›®å½•ï¼‰
- `trees.csv` - æ ‘æœ¨æ•°æ®æ–‡ä»¶ï¼ˆä½äºResources/ç›®å½•ï¼‰
- `TerrainManager` - åœ°å½¢ç®¡ç†å™¨ï¼ˆå¯é€‰ï¼Œç”¨äºåœ°å½¢é€‚é…ï¼‰

### æ¨èé…ç½®
- Unity 2022.3 LTS æˆ–æ›´é«˜ç‰ˆæœ¬
- 8GB+ RAM
- æ”¯æŒDirectX 11/12çš„æ˜¾å¡

## ğŸ› ï¸ å®‰è£…å’Œé…ç½®

### 1. å‡†å¤‡æ ‘æœ¨é¢„åˆ¶ä½“
ç¡®ä¿`Tree.prefab`ä½äº`Assets/Resources/Prefabs/`ç›®å½•ä¸­ï¼š
```
Assets/
â””â”€â”€ Resources/
    â””â”€â”€ Prefabs/
        â””â”€â”€ Tree.prefab
```

### 2. å‡†å¤‡æ ‘æœ¨æ•°æ®
å°†`trees.csv`æ–‡ä»¶æ”¾åœ¨`Assets/Resources/`ç›®å½•ä¸­ï¼š
```
Assets/
â””â”€â”€ Resources/
    â””â”€â”€ trees.csv
```

### 3. é…ç½®PowerlineExtractionSceneBuilder
åœ¨åœºæ™¯ä¸­æ‰¾åˆ°`PowerlineExtractionSceneBuilder`ç»„ä»¶ï¼Œé…ç½®ä»¥ä¸‹å‚æ•°ï¼š

#### åŸºç¡€é…ç½®
```csharp
[Header("æ ‘æœ¨é…ç½®")]
public bool enableTreePlacement = true;           // å¯ç”¨æ ‘æœ¨æ”¾ç½®
public GameObject treePrefab;                     // æ ‘æœ¨é¢„åˆ¶ä½“ï¼ˆå¯é€‰ï¼Œä¼šè‡ªåŠ¨åŠ è½½ï¼‰
public string treeCsvFileName = "trees";          // æ ‘æœ¨CSVæ–‡ä»¶å
```

#### æ”¾ç½®é…ç½®
```csharp
public int treesPerTower = 3;                     // æ¯ä¸ªç”µå¡”é™„è¿‘çš„æ ‘æœ¨æ•°é‡
public float minTreeDistanceFromTower = 8f;       // æ ‘æœ¨è·ç¦»ç”µå¡”çš„æœ€å°è·ç¦»
public float maxTreeDistanceFromTower = 25f;      // æ ‘æœ¨è·ç¦»ç”µå¡”çš„æœ€å¤§è·ç¦»
```

#### è§†è§‰æ•ˆæœé…ç½®
```csharp
public bool enableTreeAutoScaling = true;         // å¯ç”¨æ ‘æœ¨è‡ªåŠ¨ç¼©æ”¾
public Vector2 treeHeightRange = new Vector2(3f, 8f); // æ ‘æœ¨ç›®æ ‡é«˜åº¦èŒƒå›´
```

## ğŸ“Š æ•°æ®æ ¼å¼

### trees.csvæ ¼å¼
```csv
tree_id,group_id,tower_id,x,y,z,tree_type
0,0,0,295.5,335.0,4.9,Tree
1,0,0,292.0,338.0,4.8,Tree
2,0,0,296.0,334.0,4.9,Tree
3,0,1,290.0,325.0,7.7,Tree
4,0,1,293.0,329.0,7.6,Tree
```

### å­—æ®µè¯´æ˜
- **tree_id**: æ ‘æœ¨å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆæ•´æ•°ï¼‰
- **group_id**: æ‰€å±ç»„IDï¼Œä¸ç”µåŠ›çº¿åˆ†ç»„å¯¹åº”ï¼ˆæ•´æ•°ï¼‰
- **tower_id**: å…³è”çš„ç”µå¡”IDï¼ˆæ•´æ•°ï¼‰
- **x, y, z**: æ ‘æœ¨çš„3Dåæ ‡ï¼ˆæµ®ç‚¹æ•°ï¼‰
- **tree_type**: æ ‘æœ¨ç±»å‹ï¼ˆå­—ç¬¦ä¸²ï¼Œé»˜è®¤ä¸º"Tree"ï¼‰

### åæ ‡ç³»ç»Ÿ
- **è¾“å…¥åæ ‡**: CSVä¸­çš„x,y,z
- **Unityåæ ‡**: xâ†’X, yâ†’Z, zâ†’Yï¼ˆé«˜åº¦ï¼‰
- **è‡ªåŠ¨åç§»**: ç³»ç»Ÿä¼šè‡ªåŠ¨æ·»åŠ Â±2ç±³çš„éšæœºåç§»é¿å…é‡å 

## ğŸ® ä½¿ç”¨æ–¹æ³•

### è‡ªåŠ¨æ¨¡å¼ï¼ˆæ¨èï¼‰
1. ç¡®ä¿`enableTreePlacement = true`
2. è¿è¡Œç”µåŠ›çº¿æå–æµç¨‹
3. ç³»ç»Ÿä¼šè‡ªåŠ¨åœ¨å»ºç«‹ç”µå¡”å’Œç”µçº¿åæ”¾ç½®æ ‘æœ¨

### æ‰‹åŠ¨æ§åˆ¶
```csharp
// è·å–PowerlineExtractionSceneBuilderå¼•ç”¨
var builder = FindObjectOfType<PowerlineExtractionSceneBuilder>();

// é‡æ–°åŠ è½½æ ‘æœ¨
builder.ReloadTrees();

// æ¸…é™¤æ‰€æœ‰æ ‘æœ¨
builder.ClearAllTrees();
```

### è¿è¡Œæ—¶é…ç½®
```csharp
// åŠ¨æ€è°ƒæ•´æ ‘æœ¨æ•°é‡
builder.treesPerTower = 5;

// è°ƒæ•´è·ç¦»èŒƒå›´
builder.minTreeDistanceFromTower = 10f;
builder.maxTreeDistanceFromTower = 30f;

// é‡æ–°åº”ç”¨é…ç½®
builder.ReloadTrees();
```

## ğŸ”§ é«˜çº§åŠŸèƒ½

### åœ°å½¢é€‚é…
å¦‚æœåœºæ™¯ä¸­æœ‰`TerrainManager`ï¼Œæ ‘æœ¨ä¼šè‡ªåŠ¨è°ƒæ•´é«˜åº¦ä»¥è´´åˆåœ°å½¢ï¼š
```csharp
// åœ°å½¢é«˜åº¦æŸ¥è¯¢
float terrainHeight = terrainManager.GetTerrainHeight(x, z);
treePosition.y = Mathf.Max(treePosition.y, terrainHeight);
```

### æ€§èƒ½ä¼˜åŒ–
- **æœ€å¤§æ•°é‡é™åˆ¶**: é€šè¿‡`maxTrees`å‚æ•°æ§åˆ¶
- **LODæ”¯æŒ**: å¯ç”¨`useLOD`é€‰é¡¹
- **é®æŒ¡å‰”é™¤**: å¯ç”¨`enableOcclusionCulling`é€‰é¡¹

### è‡ªå®šä¹‰æ ‘æœ¨ç±»å‹
å¯ä»¥æ‰©å±•ç³»ç»Ÿæ”¯æŒä¸åŒç±»å‹çš„æ ‘æœ¨ï¼š
```csharp
// åœ¨TreeDataä¸­æ·»åŠ æ–°å­—æ®µ
public string treeType;
public float treeScale;
public Material treeMaterial;
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### Q: æ ‘æœ¨ä¸æ˜¾ç¤ºï¼Ÿ
**A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹**ï¼š
1. ç¡®è®¤`enableTreePlacement = true`
2. æ£€æŸ¥`trees.csv`æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®
3. ç¡®è®¤`Tree.prefab`åœ¨æ­£ç¡®ä½ç½®
4. æŸ¥çœ‹Consoleä¸­çš„é”™è¯¯ä¿¡æ¯

#### Q: æ ‘æœ¨ä½ç½®ä¸æ­£ç¡®ï¼Ÿ
**A: å¯èƒ½çš„åŸå› **ï¼š
1. CSVåæ ‡æ ¼å¼é”™è¯¯
2. åæ ‡è½¬æ¢é—®é¢˜
3. åœ°å½¢é€‚é…å¤±è´¥

#### Q: æ€§èƒ½é—®é¢˜ï¼Ÿ
**A: ä¼˜åŒ–å»ºè®®**ï¼š
1. å‡å°‘`treesPerTower`æ•°é‡
2. å¯ç”¨LODç³»ç»Ÿ
3. è°ƒæ•´`maxTreeDistanceFromTower`å‚æ•°
4. ä½¿ç”¨æ›´ç®€å•çš„æ ‘æœ¨æ¨¡å‹

### è°ƒè¯•å·¥å…·
```csharp
// å¯ç”¨GizmosæŸ¥çœ‹æ ‘æœ¨ä½ç½®
// åœ¨Sceneè§†å›¾ä¸­é€‰æ‹©PowerlineExtractionSceneBuilderå¯¹è±¡

// æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
Debug.Log(builder.GetStatistics());

// æ‰‹åŠ¨æµ‹è¯•æ ‘æœ¨æ”¾ç½®
builder.ReloadTrees();
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### å†…å­˜ç®¡ç†
- åˆç†è®¾ç½®æœ€å¤§æ ‘æœ¨æ•°é‡
- å®šæœŸæ¸…ç†ä¸éœ€è¦çš„æ ‘æœ¨
- ä½¿ç”¨å¯¹è±¡æ± ç®¡ç†æ ‘æœ¨å®ä¾‹

### æ¸²æŸ“ä¼˜åŒ–
- å¯ç”¨LODç³»ç»Ÿ
- ä½¿ç”¨é®æŒ¡å‰”é™¤
- ä¼˜åŒ–æ ‘æœ¨æ¨¡å‹çš„å¤æ‚åº¦

### è®¡ç®—ä¼˜åŒ–
- é™åˆ¶æ ‘æœ¨æœç´¢èŒƒå›´
- ä½¿ç”¨ç©ºé—´åˆ†åŒºç®—æ³•
- å¼‚æ­¥åŠ è½½æ ‘æœ¨æ•°æ®

## ğŸ”® æœªæ¥æ‰©å±•

### è®¡åˆ’åŠŸèƒ½
- [ ] æ”¯æŒå¤šç§æ ‘æœ¨ç±»å‹
- [ ] åŠ¨æ€å­£èŠ‚å˜åŒ–
- [ ] é£åŠ›æ•ˆæœæ¨¡æ‹Ÿ
- [ ] æ ‘æœ¨ç”Ÿé•¿åŠ¨ç”»
- [ ] æ‰¹é‡æ ‘æœ¨ç¼–è¾‘å·¥å…·

### è‡ªå®šä¹‰æ‰©å±•
ç³»ç»Ÿè®¾è®¡ä¸ºå¯æ‰©å±•æ¶æ„ï¼Œæ”¯æŒï¼š
- è‡ªå®šä¹‰æ ‘æœ¨ç”Ÿæˆç®—æ³•
- ç¬¬ä¸‰æ–¹æ ‘æœ¨æ¨¡å‹é›†æˆ
- ç¯å¢ƒå‚æ•°åŠ¨æ€è°ƒæ•´
- å¤šå¹³å°å¯¼å‡ºæ”¯æŒ

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ç”µåŠ›çº¿å¯è§†åŒ–ç³»ç»ŸæŠ€æœ¯æ–‡æ¡£](ç”µåŠ›çº¿å¯è§†åŒ–ç³»ç»ŸæŠ€æœ¯æ–‡æ¡£.md)
- [PowerlineExtractionSceneBuilder API](Scripts/PointCloud/PowerlineExtractionSceneBuilder.cs)
- [TreeManager API](Scripts/Components/TreeManager.cs)
- [EnhancedTreeManager API](Scripts/Components/EnhancedTreeManager.cs)

## ğŸ¤ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹Consoleé”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥é…ç½®å‚æ•°
3. å‚è€ƒæ•…éšœæ’é™¤éƒ¨åˆ†
4. æäº¤Issueåˆ°é¡¹ç›®ä»“åº“

---

**æ ‘æœ¨ç³»ç»Ÿ** - è®©ç”µåŠ›çº¿å·¡æ£€åœºæ™¯æ›´åŠ è‡ªç„¶ï¼ ğŸŒ³âš¡
