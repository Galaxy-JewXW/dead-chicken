# 高树危险自动检测功能说明

## 功能概述

高树危险自动检测功能是一个智能化的树木安全监测系统，能够自动识别那些比较高且对应电塔比较矮的树木，并将它们标记为危险状态。这个功能特别适用于电力线路安全监测，帮助预防因树木过高而导致的电力事故。

## 主要特性

### 🔍 智能识别
- **自动扫描场景**：自动查找场景中的所有树木和电力线对象
- **高度计算**：智能计算树木和电塔的实际高度
- **距离分析**：计算树木与最近电力线的距离
- **比例判断**：分析树木高度与电塔高度的比例关系

### ⚙️ 可配置参数
- **高树高度比例阈值**：默认0.7（70%），可调整
- **最小危险树高**：默认5米，可调整
- **高树检测距离**：默认30米，可调整
- **危险距离阈值**：与现有监测系统集成

### 🎯 危险判定标准
系统使用多重条件来判断高树危险：

1. **高度条件**：树木高度 ≥ 电塔高度 × 比例阈值
2. **距离条件**：树木与电力线距离 ≤ 检测距离阈值
3. **最小高度条件**：树木高度 ≥ 最小危险树高
4. **比例条件**：树木高度/电塔高度 > 比例阈值

### 🚨 自动标记系统
- **危险标记创建**：自动为危险树木创建3D标记
- **视觉高亮**：危险树木会显示红色高亮效果
- **信息显示**：标记显示详细的高度和距离信息
- **材质恢复**：5秒后自动恢复树木原材质

## 使用方法

### 1. 启动功能
点击UI界面中的 **"🔍 自动识别高树危险"** 按钮即可启动自动检测。

### 2. 参数调整
在参数控制区域可以调整以下参数：
- **高树高度比例阈值**：调整树木与电塔高度的比例要求
- **最小危险树高**：设置最小危险树木高度
- **高树检测距离**：设置检测范围

### 3. 查看结果
- 控制台会显示详细的检测日志
- 危险树木会在场景中显示红色高亮
- 状态栏会显示检测结果统计
- 危险树木列表会更新显示

## 技术实现

### 高度计算方法
系统使用多种方法计算对象高度：

**树木高度计算：**
- Transform的localScale.y
- Renderer的bounds.size.y
- Collider的bounds.size.y
- 取最大值作为最终高度

**电力线高度计算：**
- Transform的position.y
- Renderer的bounds.max.y
- 电力线详细信息的点数据
- 取最大值作为最终高度

### 距离计算
使用Unity的Vector3.Distance计算树木与电力线的3D距离。

### 危险标记系统
- 创建GameObject作为危险标记
- 添加MarkerPrefab组件（如果存在）
- 设置标记类型、颜色和文本信息
- 在树木上方显示标记

## 配置建议

### 推荐参数设置
- **高树高度比例阈值**：0.6-0.8（60%-80%）
- **最小危险树高**：3-8米
- **高树检测距离**：20-50米

### 场景要求
- 树木对象名称应包含"tree"、"树"、"plant"、"vegetation"等关键词
- 电力线对象应包含PowerlineInteraction组件
- 树木和电力线应有正确的Transform和Collider/Renderer组件

## 故障排除

### 常见问题
1. **未找到树木对象**
   - 检查对象命名是否包含关键词
   - 确认对象在场景中处于激活状态

2. **未找到电力线对象**
   - 检查PowerlineInteraction组件是否正确添加
   - 确认电力线对象在场景中可见

3. **高度计算不准确**
   - 检查对象的Transform、Renderer、Collider组件
   - 调整默认高度值

4. **检测结果不理想**
   - 调整高度比例阈值
   - 修改距离检测范围
   - 检查危险判定条件

### 调试信息
系统会在控制台输出详细的调试信息，包括：
- 检测到的对象数量
- 每棵树木的高度和距离信息
- 危险判定过程
- 最终检测结果

## 扩展功能

### 未来改进方向
1. **机器学习集成**：使用AI模型预测树木生长趋势
2. **实时监测**：持续监测树木生长变化
3. **预警系统**：提前预警潜在危险
4. **数据导出**：导出检测报告和统计数据
5. **多场景支持**：支持不同地形和气候条件

### 自定义扩展
开发者可以通过以下方式扩展功能：
- 修改危险判定逻辑
- 添加新的检测参数
- 自定义标记样式
- 集成第三方监测系统

## 注意事项

1. **性能考虑**：大量对象检测可能影响性能，建议分批处理
2. **准确性**：高度计算依赖于对象组件的准确性
3. **实时性**：检测结果反映当前状态，需要定期更新
4. **安全性**：检测结果仅供参考，实际安全评估需要专业人员

## 版本历史

- **v1.0**：基础高树危险检测功能
- **v1.1**：添加可配置参数
- **v1.2**：优化高度计算方法
- **v1.3**：改进危险标记系统

---

*本功能为Unity树木危险监测系统的核心组件，旨在提高电力线路安全监测的效率和准确性。*
